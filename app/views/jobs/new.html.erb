<% @page_title = 'Frakt -Ny jobb'%>
<%= render 'jobform', title: 'Sett inn Annonse' %>



<script type="text/javascript">
  $(function(){

    all_kommunes = $('#job_kommune_id').html(); // give me a list of all kommunes grouped under their fylkes

    selected_fylke = $('#job_fylke_id option:selected').text(); // get the fylke selected on the fylke select field
    optgroup = "optgroup[label='" + selected_fylke + "']";      // use the fylke selected up to filter out a list of its kommunes from all kommunes
    options = "<option value=''> Velg Kommune </option>"+ $(all_kommunes).filter(optgroup).html();  // to the list above add a prompt with empty value     
    $('#job_kommune_id').html(options);   // go to the kommune select field and fill it with the constructed kommune list above

      $('#job_fylke_id').on('change', function(){                                         
        selected_fylke = $('#job_fylke_id option:selected').text();
        optgroup = "optgroup[label='" + selected_fylke + "']";
        options = "<option value=''> Velg Kommune </option>"+ $(all_kommunes).filter(optgroup).html();  // we want the first option to be Velg kommune     
        $('#job_kommune_id').html(options);            
      });
  })

</script>
